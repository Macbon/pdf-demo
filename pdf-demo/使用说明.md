# PDF 解析位置溯源 Demo - 使用说明

## 🎯 这是什么？

这是一个基于 **TextIn API** 的 PDF 文档解析和位置溯源演示项目。

**功能：**
- 📄 上传 PDF 文件
- 🔍 调用 TextIn API 解析文档结构
- 🎨 在 PDF 上可视化显示元素位置（用彩色框标注）
- 📊 支持多页 PDF、缩放、翻页

**参考项目：** `xparse-frontend-main/`

---

## ⚡ 快速开始（3 步）

### 1️⃣ 安装依赖

```bash
cd test-pdf-demo
npm install
```

### 2️⃣ 启动项目

```bash
npm run dev
```

### 3️⃣ 打开浏览器

访问：http://localhost:3000

---

## 🎮 如何使用

### 方式 A：快速测试（推荐）

1. 上传任意 PDF 文件
2. 点击 **"使用模拟数据测试"** 按钮（绿色）
3. 立即看到效果！

### 方式 B：真实 API

1. 去 [TextIn 官网](https://www.textin.com/) 注册并获取 API Key
2. 在左侧输入 API Key
3. 上传 PDF 文件
4. 点击 **"调用 API 解析"** 按钮（蓝色）
5. 等待解析完成

---

## 📂 文件位置

```
pdf-demo/
├── xparse-frontend-main/     # 参考的原始项目
└── test-pdf-demo/             # 新建的 Demo 项目 ⭐
    ├── src/
    │   ├── app/page.tsx              # 主页面
    │   ├── components/PDFViewer.tsx  # PDF 查看器
    │   ├── lib/textin-api.ts         # API 调用
    │   └── types/textin.ts           # 类型定义
    ├── docs/                  # 详细文档
    ├── README.md              # 完整说明
    ├── QUICKSTART.md          # 快速开始指南
    └── package.json
```

---

## 🎨 界面说明

### 左侧面板
- **API Key 输入框**：输入 TextIn API Key（可选）
- **文件上传**：选择要解析的 PDF
- **解析按钮**：
  - 🔵 蓝色 = 调用真实 API
  - 🟢 绿色 = 使用模拟数据（快速测试）
- **统计信息**：显示页数和元素数量

### 右侧预览区
- **PDF 预览**：显示 PDF 内容
- **彩色标识框**：标注不同类型的元素
- **工具栏**：翻页、缩放控制

---

## 🌈 标识框颜色说明

- 🟥 **红色** = 文本
- 🟩 **绿色** = 表格
- 🟦 **蓝色** = 图片
- 🟧 **橙色** = 标题
- 🟪 **紫色** = 段落

---

## 📚 文档资源

### 新手必读
- **QUICKSTART.md** - 快速开始指南（10分钟上手）

### 进阶阅读
- **README.md** - 完整项目说明
- **docs/TEXTIN_API_GUIDE.md** - API 集成详细指南
- **docs/DEMO_FEATURES.md** - 功能详细说明

### 总结文档
- **PDF_DEMO_完成说明.md** - 项目完成总结

---

## 🔑 核心代码

### 标识框数据格式

```typescript
// 每个标识框包含 8 个坐标值（4个点）
{
  position: [x1, y1, x2, y2, x3, y3, x4, y4],
  type: "text",        // 元素类型
  content_id: 1        // 唯一 ID
}

// 按页组织
rects = [
  [rect1, rect2, ...],  // 第 1 页
  [rect3, rect4, ...],  // 第 2 页
]
```

### 坐标说明

```
(x1,y1) ──────── (x2,y2)
   │               │
   │   标识框      │
   │               │
(x4,y4) ──────── (x3,y3)
```

---

## 🛠️ 自定义配置

### 修改 API 地址

编辑 `src/lib/textin-api.ts`：

```typescript
const apiUrl = 'YOUR_API_ENDPOINT';
```

### 修改标识框颜色

编辑 `src/components/PDFViewer.tsx`：

```typescript
const typeColors = {
  text: 'rgba(255, 0, 0, 0.3)',  // 红色
  table: 'rgba(0, 255, 0, 0.3)', // 绿色
  // ...
};
```

---

## 🐛 常见问题

### Q: PDF 无法加载？
**A:** 
- 确认文件是有效的 PDF
- 等待几秒钟（大文件需要时间）
- 查看浏览器控制台错误信息

### Q: 标识框不显示？
**A:**
- 确认已点击解析按钮
- 使用"模拟数据测试"快速验证
- 检查 API 返回数据格式

### Q: API 调用失败？
**A:**
- 确认 API Key 正确
- 检查网络连接
- 参考 `docs/TEXTIN_API_GUIDE.md`

---

## 🚀 部署

### 构建生产版本

```bash
npm run build
```

### 启动生产服务器

```bash
npm start
```

### 部署到 Vercel

```bash
npm install -g vercel
vercel
```

---

## 💡 核心技术

- **Next.js 16** - React 框架
- **React 19** - UI 库
- **TypeScript** - 类型安全
- **Tailwind CSS** - 样式
- **react-pdf** - PDF 渲染
- **SVG** - 标识框绘制

---

## 🎓 与参考项目的对比

| 特性 | xparse-frontend | test-pdf-demo |
|------|----------------|---------------|
| 复杂度 | 高（生产级） | 低（演示级） |
| PDF 渲染 | pdf.js 原生 | react-pdf |
| 框架 | Umi | Next.js |
| 学习曲线 | 陡峭 | 平缓 |
| 适用场景 | 生产环境 | Demo/学习 |

---

## ✨ 实现的功能

- ✅ PDF 文件上传
- ✅ PDF 多页预览
- ✅ 缩放控制（50% - 300%）
- ✅ 翻页控制
- ✅ TextIn API 调用
- ✅ 标识框可视化
- ✅ 多种元素类型支持
- ✅ 模拟数据测试模式
- ✅ 错误处理
- ✅ 响应式布局

---

## 📞 获取帮助

### 在线资源
- [TextIn 官网](https://www.textin.com/)
- [Next.js 文档](https://nextjs.org/docs)
- [React-PDF 文档](https://github.com/wojtekmaj/react-pdf)

### 项目文档
查看 `test-pdf-demo/docs/` 目录下的详细文档

---

## 🎉 开始使用吧！

1. 进入项目：`cd test-pdf-demo`
2. 安装依赖：`npm install`
3. 启动项目：`npm run dev`
4. 打开浏览器：http://localhost:3000
5. 上传 PDF，点击"使用模拟数据测试"

**就是这么简单！** 🚀

---

## 📝 License

MIT

---

**如有问题，请查看详细文档或提交 Issue。**

祝使用愉快！😊

